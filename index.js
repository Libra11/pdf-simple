/*
 * @Author: Libra
 * @Date: 2021-07-07 19:34:54
 * @LastEditTime: 2023-03-22 18:34:16
 * @LastEditors: Libra
 * @Description:
 * @FilePath: /pdf-simple/index.js
 */
// const puppeteer = require("puppeteer");
const { PDFDocument } = require('pdf-lib')
const { chromium, firefox, webkit } = require('playwright');
const fs = require('fs')

const waitTillHTMLRendered = async (page, timeout = 30000) => {
  const checkDurationMsecs = 1000;
  const maxChecks = timeout / checkDurationMsecs;
  let lastHTMLSize = 0;
  let checkCounts = 1;
  let countStableSizeIterations = 0;
  const minStableSizeIterations = 3;

  while (checkCounts++ <= maxChecks) {
    let html = await page.content();
    let currentHTMLSize = html.length;

    let bodyHTMLSize = await page.evaluate(
      () => document.body.innerHTML.length
    );

    console.log(
      "last: ",
      lastHTMLSize,
      " <> curr: ",
      currentHTMLSize,
      " body html size: ",
      bodyHTMLSize
    );

    if (lastHTMLSize != 0 && currentHTMLSize == lastHTMLSize)
      countStableSizeIterations++;
    else countStableSizeIterations = 0; //reset the counter

    if (countStableSizeIterations >= minStableSizeIterations) {
      console.log("Page rendered fully..");
      break;
    }

    lastHTMLSize = currentHTMLSize;
    // await page.waitFor(checkDurationMsecs);
    await page.waitForTimeout(checkDurationMsecs);
  }
};
// 页脚
const footerTemplate = `<style>
.footer {
  font-family: -apple-system, BlinkMacSystemFont, opensans, Optima, "Microsoft Yahei", sans-serif;
  font-weight: 400;
}
</style>
<div style="height: 20px;"></div>
<div
class="footer"
style="
  width: 100%;
  margin: 20px 40px;
  font-size: 8px;
  display: flex;
  font-size: 12px;
  justify-content: space-between;
"
>
<div style="display: flex; justify-content: center; align-items: center">
  <i
    style="
      margin-right: 10px;
      width: 3px;
      height: 20px;
      border-radius: 5px;
      background-color: #cd5d58;
      -webkit-print-color-adjust: exact;
    "
  ></i>
  <span style="color: #cd5d58">
    Career Psychological Risk Test Report
  </span>
</div>
<div style="color: #cd5d58; display: flex;
justify-content: center;
align-items: center;">
  <span>小新 | <span class="date" style="color: #cd5d58"> </span> | </span
  >&nbsp;<span class="pageNumber" style="color: #cd5d58"> </span> <i
  style="
    margin-left: 10px;
    width: 3px;
    height: 20px;
    border-radius: 5px;
    background-color: #cd5d58;
    -webkit-print-color-adjust: exact;
  "
></i>
</div>
</div>`;
// 页眉
const headerTemplate = `<div style="height: 200px;"></div><style>
.footer {
  font-family: -apple-system, BlinkMacSystemFont, opensans, Optima, "Microsoft Yahei", sans-serif;
}
</style><div
class="header"
style="
  width: 100%;
  padding: 0 20px;
  margin: 20px;
  font-size: 10px;
  display: flex;
  align-items: center;
  justify-content: space-between;
"
>
<div
  style="
    height: 100%;
    background-color: #cd5d58;
    -webkit-print-color-adjust: exact;
    width: 204px;
    display: flex;
    height: 26px;
    justify-content: center;
    align-items: center;
  "
>
  <img style="
  height: 28px;
  -webkit-print-color-adjust: exact;
  width: 200px;
  border-radius: 10px;
  background-color: #fff;
" src='data:image/svg+xml;base64,PHN2ZyBpZD0i5Zu+5bGCXzEiIGRhdGEtbmFtZT0i5Zu+5bGCIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDEzOTUuODggMjEzLjcxIj48ZGVmcz48c3R5bGU+LmNscy0xe2ZpbGw6I2Y3MmIwZDt9LmNscy0ye2ZpbGw6IzIwMjU0Mjt9PC9zdHlsZT48L2RlZnM+PHRpdGxlPuWbveaKleS6uuWKm2xvZ288L3RpdGxlPjxyZWN0IGNsYXNzPSJjbHMtMSIgeD0iMjQwLjgyIiB5PSI1MC4zMiIgd2lkdGg9IjEwOC40MSIgaGVpZ2h0PSIxMDguNDEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzLjMzIDI0MC45NSkgcm90YXRlKC00NS4zNSkiLz48cmVjdCBjbGFzcz0iY2xzLTEiIHg9IjE5MS4xOCIgeT0iMTI4Ljg3IiB3aWR0aD0iMTE3LjQzIiBoZWlnaHQ9IjExLjk2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMjIuMTYgMjE2LjE5KSByb3RhdGUoLTQ1KSIvPjxyZWN0IGNsYXNzPSJjbHMtMSIgeD0iMTc5LjQ2IiB5PSIxMTkuNDgiIHdpZHRoPSIxMDYuMTYiIGhlaWdodD0iMTEuOTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yMC42MSAyMDEuMTgpIHJvdGF0ZSgtNDUpIi8+PHJlY3QgY2xhc3M9ImNscy0xIiB4PSIxNjYuNiIgeT0iMTA3LjM0IiB3aWR0aD0iMTAyLjciIGhlaWdodD0iMTEuOTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNi4yOSAxODcuMykgcm90YXRlKC00NSkiLz48cmVjdCBjbGFzcz0iY2xzLTEiIHg9IjE1Mi4yMiIgeT0iOTEuNTMiIHdpZHRoPSIxMDkuNiIgaGVpZ2h0PSIxMS45NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTguMzIgMTc0Ljk1KSByb3RhdGUoLTQ1KSIvPjxyZWN0IGNsYXNzPSJjbHMtMSIgeD0iMTM4Ljg2IiB5PSI3OC4xNyIgd2lkdGg9IjEwOS42IiBoZWlnaHQ9IjExLjk2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMi43OCAxNjEuNTgpIHJvdGF0ZSgtNDUpIi8+PHJlY3QgY2xhc3M9ImNscy0xIiB4PSIxMjUuNDkiIHk9IjY0LjgiIHdpZHRoPSIxMDkuNiIgaGVpZ2h0PSIxMS45NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi43NiAxNDguMjEpIHJvdGF0ZSgtNDUpIi8+PHJlY3QgY2xhc3M9ImNscy0xIiB4PSIxMTAuODMiIHk9IjEzNC40OCIgd2lkdGg9IjExMS43MiIgaGVpZ2h0PSI3LjUzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNDguOTMgMTU4LjM2KSByb3RhdGUoLTQ1KSIvPjxyZWN0IGNsYXNzPSJjbHMtMSIgeD0iOTcuMjYiIHk9IjEyMC45MSIgd2lkdGg9IjExMS43MiIgaGVpZ2h0PSI3LjUzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNDMuMzEgMTQ0Ljc5KSByb3RhdGUoLTQ1KSIvPjxyZWN0IGNsYXNzPSJjbHMtMSIgeD0iODMuNjkiIHk9IjEwNy4zNCIgd2lkdGg9IjExMS43MiIgaGVpZ2h0PSI3LjUzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzcuNjkgMTMxLjIyKSByb3RhdGUoLTQ1KSIvPjxyZWN0IGNsYXNzPSJjbHMtMSIgeD0iNzAuMTEiIHk9IjkzLjc2IiB3aWR0aD0iMTExLjcyIiBoZWlnaHQ9IjcuNTMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zMi4wNyAxMTcuNjQpIHJvdGF0ZSgtNDUpIi8+PHJlY3QgY2xhc3M9ImNscy0xIiB4PSI1Ni41NCIgeT0iODAuMTkiIHdpZHRoPSIxMTEuNzIiIGhlaWdodD0iNy41MyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI2LjQ0IDEwNC4wNykgcm90YXRlKC00NSkiLz48cmVjdCBjbGFzcz0iY2xzLTEiIHg9IjQyLjk3IiB5PSI2Ni42MiIgd2lkdGg9IjExMS43MiIgaGVpZ2h0PSI3LjUzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMjAuODIgOTAuNDkpIHJvdGF0ZSgtNDUpIi8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNNDcwLjM2LDU5LjEydjUzLjMyYTguMTcsOC4xNywwLDAsMS0uNzcsMyw2LjkzLDYuOTMsMCwwLDEtMi4zMywyLjEyLDE0LjI4LDE0LjI4LDAsMCwxLTMuOCwxLjIsMjYsMjYsMCwwLDEtMy44LjI5SDQwMy43OXYtNjBabS01Niw1My4zMmg0NS4zNFY2NS42NEg0MTQuMzNabTE3LjQ0LTI3Ljc2Vjc3LjExSDQxOFY3MWgzNy45djYuMDlINDQxLjN2Ny41N0g0NTV2Ni4wOWgtNS41MXEyLjcyLDMuNjksNS42Niw3LjIzTDQ1MywxMDAuMjZoNC42NXY2LjE2SDQxNi4yN3YtNi4xNmgxNS41VjkwLjc3SDQxOS4wNlY4NC42OFpNNDQ3LDkwLjc3SDQ0MS4zdjkuNDloMTAuODVhMTguNTcsMTguNTcsMCwwLDEtNS44MS0yLjgzLDE3Ljg5LDE3Ljg5LDAsMCwxLTMuNzItNC4zMloiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik00OTkuNSw2OS4xaDcuNjdWNzZINDk5LjV2OS43cTIuMzMtLjYzLDQuNzMtMS40MWwuOTMsNC44MWEyNy44MSwyNy44MSwwLDAsMS01LjY2LDMuMDV2MjAuMzJhMTIuNjQsMTIuNjQsMCwwLDEtLjQ2LDIuNzYsNiw2LDAsMCwxLTEuNzksMi43Niw4LjMyLDguMzIsMCwwLDEtMy4xOCwxLjQ5LDE4LjQ2LDE4LjQ2LDAsMCwxLTQuNTcuNTcsOS42MSw5LjYxLDAsMCwxLTMuNDgtLjc4LDE1LjU1LDE1LjU1LDAsMCwxLTMuODgtMi42OXYtMy40bDQuNDIuMzVhMy43MSwzLjcxLDAsMCwwLDIuNC0uNjMsMi43OCwyLjc4LDAsMCwwLC40Ny0xLjIxLDExLjgzLDExLjgzLDAsMCwwLC4xNS0xLjkxdi0xNHEtNC4xOCwxLjM1LTguMzcsMi40MWwtMS40Ny03LjA4cTQuODgtMS4yNyw5Ljg0LTIuNjJWNzZoLTcuOVY2OS4xaDcuOVY1Ny4yMWg5LjkyWm00OCwxNS40NHY2LjUyYTQ4LjIyLDQ4LjIyLDAsMCwxLTE0LDE2LjY0LDU2LDU2LDAsMCwwLDcuOTEsNHE1LjczLDIuMzQsMTEuNyw0LjI1bC0xLjc4LDQuNzVhMTI1LjM0LDEyNS4zNCwwLDAsMS0xNC41LTQuMjVBNzIuMyw3Mi4zLDAsMCwxLDUyNi43LDExMmE4My42NCw4My42NCwwLDAsMS0xMS42Miw1cS02LjQ0LDIuMTMtMTIuOTQsMy42MWwtMi00LjUzYTg1LDg1LDAsMCwwLDE5LjUzLTguNjRBNDMuMTMsNDMuMTMsMCwwLDEsNTA4LDkzLjc1bDcuMDYtMi41NUg1MDZWODQuNTRabS02LjUxLTNhMTQuMTcsMTQuMTcsMCwwLDEtNC0uNDMsNy4zLDcuMywwLDAsMS0yLjk0LTEuMzRBNS42Niw1LjY2LDAsMCwxLDUzMS44OSw3NVY2Ni4ySDUyMS40M1Y3MGExMi45MSwxMi45MSwwLDAsMS0uNyw0LjI0LDEwLDEwLDAsMCwxLTIuNDgsNCwxNy4xNywxNy4xNywwLDAsMS01LjExLDMuNTQsMzUuNjQsMzUuNjQsMCwwLDEtNi4wNSwyLjEzbC0yLjYzLTMuNTVhMjQsMjQsMCwwLDAsMy4xLTIuNTUsMTIuMjYsMTIuMjYsMCwwLDAsMi4yNS0zLjExLDE0LDE0LDAsMCwwLC43LTIuNDhjLjE1LTEuNy4yMy0zLjQuMjMtNS4xVjU5LjloMzEuNjl2MTJhNS44OCw1Ljg4LDAsMCwwLC4wOCwxLjYzLDEuODMsMS44MywwLDAsMCwuNDcsMSwxLjg1LDEuODUsMCwwLDAsLjc3LjQyLDUsNSwwLDAsMCwxLjcxLjE0SDU1MWwtLjc4LDYuMzhabS0xNC40OSwyMWEzOC42MSwzOC42MSwwLDAsMCw5LjIyLTExLjI2SDUxOC4xYTM2LjExLDM2LjExLDAsMCwwLDguMzcsMTEuMjYiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik02MDguNTQsMTA3LjA2YTU2LjY0LDU2LjY0LDAsMCwxLTEzLjQxLTE3Ljc3LDUzLjEsNTMuMSwwLDAsMS0xMy4zMywxNy41Niw3OS44OCw3OS44OCwwLDAsMS0xMC40Niw3LjU3cS00LjgsMi44My05Ljc2LDUuMzFsLTIuNzEtNC4yNGMyLjc4LTEuOCw1LjUtMy43MSw4LjEzLTUuNzRhNzUuODcsNzUuODcsMCwwLDAsNi43NC01Ljg4LDYyLjU1LDYyLjU1LDAsMCwwLDcuNTItOS4zNCw1MSw1MSwwLDAsMCw1Ljg5LTE0QTc0LjgzLDc0LjgzLDAsMCwwLDU4OSw2My45NGwuMjMtNi4zOGgxMC44NXEtLjA4LDQuNjgtLjA3LDkuMjFsLS4yNCwzLjY4YTU3LjY5LDU3LjY5LDAsMCwwLDksMjQuMjIsNjYuODMsNjYuODMsMCwwLDAsOS43NywxMS40Nyw4Mi42LDgyLjYsMCwwLDAsMTIuNzEsOS43N2wtMi43MSw0LjUzYTk4LjYzLDk4LjYzLDAsMCwxLTIwLTEzLjM4Ii8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNNjcyLjk0LDcwaDMyLjMycS0uODUsMTkuNDctMS45NCwzOC44N2ExNC42MywxNC42MywwLDAsMS0xLjMyLDUuMzgsMTAuMzUsMTAuMzUsMCwwLDEtMi4xNywyLjc2LDEzLjQyLDEzLjQyLDAsMCwxLTUsMi4xMywzNy41NCwzNy41NCwwLDAsMS03LjI5LjcsMjYuNjgsMjYuNjgsMCwwLDEtNi42Ny0uODQsMzQuOCwzNC44LDAsMCwxLTcuMi0yLjkxVjExMi4zbDEwLjE1LjM1YTE5Ljc1LDE5Ljc1LDAsMCwwLDQuNDItLjM1LDguNTIsOC41MiwwLDAsMCwyLjE3LS44NSw1LjExLDUuMTEsMCwwLDAsMS41NS0yLjI3LDE4LjMzLDE4LjMzLDAsMCwwLC41NC0zLjgycS43MS0xMy44NywxLjI0LTI3LjlINjcyLjYzYy0uMiwyLjgzLS40OSw1LjY0LS44NSw4LjQzYTcwLjIsNzAuMiwwLDAsMS0xLjQ3LDcuMjksNTIuMzcsNTIuMzcsMCwwLDEtMi40MSw2LjIzLDM5LjA1LDM5LjA1LDAsMCwxLTMuNTYsNS41Miw0OC41Niw0OC41NiwwLDAsMS04LDcuMjNxLTMuNjUsMi40LTcuNTIsNC40Ni00LjY1LDIuNC05LjM4LDQuNTNsLTIuNzktNC4yNWE5Ny42OCw5Ny42OCwwLDAsMCwxMi4yNS04LjY0LDM0LjczLDM0LjczLDAsMCwwLDcuNTItOC45MiwzOCwzOCwwLDAsMCwzLjI1LTcuOTMsNzkuNzksNzkuNzksMCwwLDAsMi0xNEg2NDFWNzBoMjFsLjU0LTEzLjE4aDEwLjg1cS0uMTcsNi42Ni0uNDcsMTMuMTgiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik03MzIuNyw3MC44OGwzLjg3LDMuNTRhMTcuODIsMTcuODIsMCwwLDEtMi4xNywyLjlxLTEuNDcsMS42NC0zLjE4LDMuMTktNC40MSwzLjg4LTkuMjIsNy4zNmwtNS4xMi01Ljc0cTgtNS40NCwxNS44Mi0xMS4yNW0yNiwzMC41MWExMy42OSwxMy42OSwwLDAsMS0xLjE2LDQuMzlxMTQuODgsNS4xLDI5Ljc2LDEwLjQ4bC0xLjU1LDQuNDdxLTcuNjYtMS42NC0xNS4xOS0zLjktOC43Ni0yLjU1LTE3LjI4LTUuNzRhMjYuNDcsMjYuNDcsMCwwLDEtNS41OCwzLjE5QTY2LjEzLDY2LjEzLDAsMCwxLDc0MCwxMTdhMTUxLjA5LDE1MS4wOSwwLDAsMS0xOS41MywzLjY4bC0xLjctNC42cTYtMS4yLDExLjkzLTIuNzZhNDguNzcsNDguNzcsMCwwLDAsMTAtMy43NSwxNS45MSwxNS45MSwwLDAsMCw1LTQsOS43Myw5LjczLDAsMCwwLDEuNjMtNC4yNSwzOC43MywzOC43MywwLDAsMSwuNTQtNC4xN2gxMS4zMWE0My4xMSw0My4xMSwwLDAsMC0uMzksNC4zMU03MTkuNjgsNjEuODFsNS01LjFxNi42LDQuNjgsMTMuMzMsOS4xNEw3MzYsNjkuNzRhMzcuODcsMzcuODcsMCwwLDEtMTYuMzUtNy45M003MjYuMzQsODlINzgwLjJ2MTQuMzhhNC45LDQuOSwwLDAsMS0xLjI0LDMuMzMsNS43LDUuNywwLDAsMS00LDEuMzRoLTUuMTlWOTUuMjNINzM2LjU3djguMjJhNC44LDQuOCwwLDAsMS0xLjI0LDMuMjYsNS40NCw1LjQ0LDAsMCwxLTMuODgsMS4zNGgtNS4xMVptNDUuMzQtNC4xOGEyOC4xNywyOC4xNywwLDAsMS0xMC41NC01LjUyLDIwLjUzLDIwLjUzLDAsMCwxLTQuNSwzLjEyLDM0LjMzLDM0LjMzLDAsMCwxLTYuMiwyLjQsNzguODYsNzguODYsMCwwLDEtMTUuMjcsMi43N2wtMS4zOS00YTc2LjY5LDc2LjY5LDAsMCwwLDcuODMtMiw0MC40Niw0MC40NiwwLDAsMCw3LjM2LTMsMTYuODMsMTYuODMsMCwwLDAsNC4yNi0zLjI2LDguNjgsOC42OCwwLDAsMCwxLjk0LTMuNTRsLjc3LTIuNTVINzY2LjFjLS4xNi44NS0uMzQsMS42Ny0uNTUsMi40OGwtLjMxLDEuMjdhMjAuNDEsMjAuNDEsMCwwLDAsMy43MiwzLjQsMzQuMzEsMzQuMzEsMCwwLDAsNS41OCwyLjksNjcuNjQsNjcuNjQsMCwwLDAsMTQuNjUsMy45bC0xLjU1LDQuMjVhNzUuNTcsNzUuNTcsMCwwLDEtMTYtMi43bTQuNDktMTcuMjdINzUxLjQ1YTMyLjMyLDMyLjMyLDAsMCwxLTExLjcsNy41N2wtMi42NC0yLjc2YTQyLjQxLDQyLjQxLDAsMCwwLDYuMTItNy4yOSw3MC41Niw3MC41NiwwLDAsMCw1LjItOS4xM2wxMC4wNy43cS0xLjE1LDIuNTUtMi40OCw0Ljg5aDMwLjY5djZhNTMuOCw1My44LDAsMCwxLTkuMzgsNy4yMmwtNS44OS0xLjYzYTM3LjMyLDM3LjMyLDAsMCwxLDQuNzMtNS41MiIvPjxwYXRoIGNsYXNzPSJjbHMtMiIgZD0iTTgwNS43OCw4NS42OGEzOSwzOSwwLDAsMS0zLjQxLTJxLTIuNjQtMS43Ny01LTMuNzVjLS42Ny0uNTItMS4zMi0xLTEuOTQtMS41Nmw1LjY2LTUuMjRxMy42NSwyLjc2LDcuMjEsNS42NywzLjQsMi43Niw3LDUuMzFsLTIuMjUsNGEyNy4yNCwyNy4yNCwwLDAsMS03LjItMi40bS04LDI5LjE3cS45My0yLjQ3LDEuNzEtNS4xLDIuNDctNy45NCw0LjY1LTE1Ljg2Yy4xNS0uNTIuMzEtMSwuNDYtMS41Nmw2LjgyLDEuMTNhMzEuMzMsMzEuMzMsMCwwLDEtLjE1LDUuMzlxLS4zMSwzLjE4LS45Myw2LjM3LS44Niw0LjE3LTIuMDksOC4yMWE0MC4zNyw0MC4zNywwLDAsMS0yLjI1LDYuNDVsLTkuNjEtMS43N2EzMi45MSwzMi45MSwwLDAsMCwxLjM5LTMuMjZtNTMuNTYtNDguNDRBMjcuNiwyNy42LDAsMCwxLDg1MCw3MGExMy4zLDEzLjMsMCwwLDEtMS42MywyLjMzaDE2VjkzLjE4YTQuODIsNC44MiwwLDAsMS0yLjE3LDQuMTEsOC43NSw4Ljc1LDAsMCwxLTMsMS4yNywyMC4yNCwyMC4yNCwwLDAsMS00LjQyLjM2aC0zLjQ4djEzYTE1LjMxLDE1LjMxLDAsMCwxLS41NSw0LDYsNiwwLDAsMS0xLjc4LDIuNTUsOS41Myw5LjUzLDAsMCwxLTIuNCwxLDIyLjY4LDIyLjY4LDAsMCwxLTQuNzMuNSwxMS42MiwxMS42MiwwLDAsMS0zLjU3LS43MSwxNy4xMSwxNy4xMSwwLDAsMS00LTIuNDh2LTMuMTFsNC4yNy4zNWE2LjY2LDYuNjYsMCwwLDAsMS44Ni0uMjgsNC42Niw0LjY2LDAsMCwwLC43Ny0uNTcsMy44MiwzLjgyLDAsMCwwLC40Ny0xLjQ5Yy4wNS0uNzUuMDgtMS41My4wOC0yLjMzVjk4LjkyaC0xM1Y3Mi4zNmgxMC44NWE1NS42OSw1NS42OSwwLDAsMCwxLjctNmgtMTQuOHYxN2ExMjIuNTksMTIyLjU5LDAsMCwxLS42MiwxMi4zMiw0NC4wOCw0NC4wOCwwLDAsMS0yLjU2LDEwLDMxLjg0LDMxLjg0LDAsMCwxLTUuNDIsOC42NCw2OS4wNyw2OS4wNywwLDAsMS02LjUxLDYuNTJsLTMuMTgtMmE2MC43LDYwLjcsMCwwLDAsNi41OS0xNS4xNSw2OS43Niw2OS43NiwwLDAsMCwxLjU1LTkuMDZjLjMxLTMuNjguNDYtNy4zNy40Ni0xMVY2OS4yNWwtMS42MywzQTIyLjY3LDIyLjY3LDAsMCwxLDgwOC40MSw3MGEyNi45NCwyNi45NCwwLDAsMS0zLjI1LTEuOTJxLTIuNDktMS43Ny00LjgxLTMuNjFsLTEuODYtMS41Niw1Ljc0LTUuMDljMi4xNywxLjcsNC4zMSwzLjQ0LDYuNDMsNS4yNHEyLjk0LDIuNDcsNi4xMiw0LjgxVjU5Ljc2aDUwLjc2djYuNjVabS0xNS44OSw0My4yYTMzLjU2LDMzLjU2LDAsMCwxLTQuMTEsNC4zMiwyNi4xMywyNi4xMywwLDAsMS04LjYsNS4xbC0yLjQ4LTIuNjlhNzgsNzgsMCwwLDAsMTEuMTYtMTVsNy44MywzcS0xLjc4LDIuNzYtMy44LDUuMzFtMi43MS0yNi44NGgxNi42NlY3OC4xSDgzOC4xN1ptMTYuNjYsNS42N0g4MzguMTd2NC43NGgxNi42NlptNi41MSwyNi4wNWE1OS4wNSw1OS4wNSwwLDAsMS03Ljc1LTguMjhjLS40Ni0uNTItLjktMS4wNi0xLjMyLTEuNjNsNy4yMS0zLjI2cTUuODIsNy4zMSwxMS40LDE0LjhsLTIuNzIsMi40OGEyMy4yOSwyMy4yOSwwLDAsMS02LjgyLTQuMTEiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik04NzYuMjIsMTEyLjc5YTMxLjksMzEuOSwwLDAsMCwxLjk0LTYuNThxLjU0LTMuMzMuNzgtNi43My4zOC02LjQ0LjM4LTEzVjU5LjY5aDI1LjI3djUzYTEwLjg0LDEwLjg0LDAsMCwxLS42MiwzLjU1LDUuNTIsNS41MiwwLDAsMS0xLjI0LDEuNjksNy42LDcuNiwwLDAsMS0zLDEuMzUsMjYuMTEsMjYuMTEsMCwwLDEtNC42NS40MiwxMC4zMiwxMC4zMiwwLDAsMS0zLjQxLS43LDE3LjkzLDE3LjkzLDAsMCwxLTMuNDEtMi4yLDIuMTksMi4xOSwwLDAsMS0uMzktLjI4di0zLjE5bDQuMzQuMzZhNy41Myw3LjUzLDAsMCwwLDEuNzgtLjIyLDIsMiwwLDAsMCwuNzgtLjQyLDIuMjcsMi4yNywwLDAsMCwuNDYtMS4wNiwxMS41NiwxMS41NiwwLDAsMCwuMTYtMS44NVY5OC43aC03LjQ1YTM0LDM0LDAsMCwxLTMuNTYsMTIuMTgsMzYuNTgsMzYuNTgsMCwwLDEtOC4yOSw5LjkybC0zLTIuMTNxMS43MS0yLjksMy4xLTUuODhtMTIuMDktMjAuMjVoNy4wNlY4Mi4zNWgtN3Y2Ljk0YzAsMS4xMywwLDIuMjEtLjA4LDMuMjVtLjA4LTE2LjM1aDd2LTEwaC03Wk05NDMuOCw1OS42MnEtLjMsNi4xNS0uNjIsMTIuMThhMTIuODQsMTIuODQsMCwwLDEtLjY5LDMuNzUsNi4xMSw2LjExLDAsMCwxLTEuMjUsMS44NCw2LjM1LDYuMzUsMCwwLDEtMywxLjM1LDIyLjA5LDIyLjA5LDAsMCwxLTQuNjUuMzUsMjEuNTksMjEuNTksMCwwLDEtNS41OC0uNTdBMjUsMjUsMCwwLDEsOTIyLDc2VjcyLjkzbDcuNTkuMzVhNiw2LDAsMCwwLDMuMTgtLjU2LDMuMTYsMy4xNiwwLDAsMCwxLjA4LTIuNjJsLjMxLTMuODNIOTE3LjkyVjgyLjU2aDI2LjgxdjYuM2E0MS43LDQxLjcsMCwwLDEtOS4xNCwxNy41Niw0OC4xNCw0OC4xNCwwLDAsMCw1LjExLDQuNDZjMi4zMywxLjcsNC43NSwzLjM1LDcuMjksNWwtMiw0YTYzLjE5LDYzLjE5LDAsMCwxLTguMjEtMy44Miw0MS4xOCw0MS4xOCwwLDAsMS03LTQuODEsNzAuMjEsNzAuMjEsMCwwLDEtMTEuMjQsNy4zNmwtMS41NS0zdi43OGE0LjIxLDQuMjEsMCwwLDEtMS40OCwzLjI1LDQuNzcsNC43NywwLDAsMS0zLjEsMS4wN2gtNC40OXYtNjFaTTkyNi4yMSw4OS43MWE0My41Niw0My41NiwwLDAsMCw0LjczLDEwLjg0LDQyLjUzLDQyLjUzLDAsMCwwLDUuMTktMTEuNjlIOTE3LjkyVjExM2E2Ni41OSw2Ni41OSwwLDAsMCw4LjIxLTYuNjYsMzMuNDYsMzMuNDYsMCwwLDEtNC02LjMsNzEuODcsNzEuODcsMCwwLDEtMy40OC04LjQzWiIvPjxwYXRoIGNsYXNzPSJjbHMtMiIgZD0iTTk4Mi4xNiw4MC40M2E3Ni4zNyw3Ni4zNywwLDAsMS0xMS4zOS03LjcxLDU1LjEsNTUuMSwwLDAsMS0xMy44Nyw2LjcyTDk1NSw3NmE4MS40Miw4MS40MiwwLDAsMCwxMS4zOS05LjIsNzkuMzEsNzkuMzEsMCwwLDAsMTAtMTEuMzNsOS4zLDIuODNjLTEuMTQsMS40Mi0yLjI3LDIuNzktMy40MSw0LjExaDM3LjU5djUuNzNBMTA3Ljc3LDEwNy43NywwLDAsMSw5OTkuMjEsODFhMTEzLjI1LDExMy4yNSwwLDAsMCwxMy4yNSwzLjc2cTcuMTQsMS41NSwxNC40MiwyLjU0bC0uOTMsNC43NWExNjMuMjQsMTYzLjI0LDAsMCwxLTE4LjYtMi42Miw5NC4xOSw5NC4xOSwwLDAsMS0xNi41MS00Ljg5QTk3LjcxLDk3LjcxLDAsMCwxLDk4MCw4OGw5LjQ2LjA3cS0uNDcsMy4xOS0uOTMsNi4zaDI5LjUzcS0uOTMsOC41LTIuMSwxNi45M2ExMi4yMywxMi4yMywwLDAsMS0xLjMxLDQsNy41Nyw3LjU3LDAsMCwxLTIuNzksMi42MiwxNiwxNiwwLDAsMS0zLjQ5LDEuMTQsNDAuNTcsNDAuNTcsMCwwLDEtNi42Ny41NiwzMy4yMywzMy4yMywwLDAsMS02Ljg5LS43MSwzOSwzOSwwLDAsMS03LjQ0LTIuNHYtM2wxMC43Ny4zNmExOC4zNCwxOC4zNCwwLDAsMCwzLjY0LS4zNiw4LjY3LDguNjcsMCwwLDAsMS43OC0uNTYsMy40LDMuNCwwLDAsMCwxLjQtMS43LDEyLjg5LDEyLjg5LDAsMCwwLC43Ny0yLjc2Yy4zMS0yLjY1LjY3LTUuMjksMS4wOS03Ljk0SDk4Ny4wNUEyMi43NSwyMi43NSwwLDAsMSw5NzcsMTEzLjI5LDU1Ljc3LDU1Ljc3LDAsMCwxLDk2Ni45LDExOGMtMy40NywxLjE0LTYuOTUsMi4xNS0xMC40NywzLjA1bC0yLTRxNC43My0xLjY5LDkuMy0zLjgyYTQxLjY5LDQxLjY5LDAsMCwwLDUtMy4wNSwyMC41NiwyMC41NiwwLDAsMCw3LjU5LTkuNTZIOTU4Ljg0Vjk0LjM4aDE5cS40Ni0yLjg5Ljc4LTUuOTRBMjAyLjEsMjAyLjEsMCwwLDEsOTU0Ljg4LDkzbC0xLjE2LTQuNzVhMTUzLjc3LDE1My43NywwLDAsMCwyOC40NC03Ljc5TTk5MC4wNyw3N2E2Ny4zNSw2Ny4zNSwwLDAsMCwxNC4zNC04Ljg2SDk3Ny44MkE0OC44OSw0OC44OSwwLDAsMCw5OTAuMDcsNzciLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik0xMDY3LjgsNjMuODdoMzYuNTh2Ni42NWgtNDAuM2E2OC40Niw2OC40NiwwLDAsMS00LjM0LDYuMjNoMzcuODJ2MzUuMTJhMTIsMTIsMCwwLDEtLjcsNCw3LjE2LDcuMTYsMCwwLDEtMS40NywyLDkuMjIsOS4yMiwwLDAsMS0zLjQxLDEuNjMsMjguNDksMjguNDksMCwwLDEtNS4yNy41LDIyLjQ1LDIyLjQ1LDAsMCwxLTUuNjYtLjcxLDMxLjQ4LDMxLjQ4LDAsMCwxLTYuMi0yLjQ4di0zLjE4bDguMjkuMzVhOS43Nyw5Ljc3LDAsMCwwLDIuMzMtLjI4LDIuODksMi44OSwwLDAsMCwxLS41LDIsMiwwLDAsMCwuNTQtMS4yLDEzLjc3LDEzLjc3LDAsMCwwLC4xNS0yLjA2di0yLjU1aC0zMS4yM3Y3Ljg2YTQuNjQsNC42NCwwLDAsMS0xLjYyLDMuNTQsNS43Nyw1Ljc3LDAsMCwxLTMuNDksMS4xNGgtNS4xMlY5MC40MmE4Mi45Miw4Mi45MiwwLDAsMS0xMS44NSw2LjhsLTEuNzEtNC44OWE4OS4zMSw4OS4zMSwwLDAsMCwyMC4zOC0yMS44MWgtMTYuNzRWNjMuODdoMjAuNjJhNzUuMzYsNzUuMzYsMCwwLDAsMy41Ni04bDExLjMyLjc4Yy0xLjA5LDIuNDYtMi4yNSw0Ljg2LTMuNDksNy4yM20tMTEuODYsMjUuMmgzMS4yNFY4M2gtMzEuMjRabTAsMTIuMzJoMzEuMjRWOTVoLTMxLjI0WiIvPjxwYXRoIGNsYXNzPSJjbHMtMiIgZD0iTTExMTQuNTMsNTkuMTloMjQuOHY2LjE2bC01Ljg5LDE1LjU4YTQyLjcxLDQyLjcxLDAsMCwxLDQuNSw5LDI1LjIzLDI1LjIzLDAsMCwxLDEuMzksNy4zLDM4LDM4LDAsMCwxLS4zOSw0LjI0LDEwLjYyLDEwLjYyLDAsMCwxLTEuNywzLjgzLDcuMiw3LjIsMCwwLDEtMywyLjEyLDEwLDEwLDAsMCwxLTQuMS40Myw1LjU4LDUuNTgsMCwwLDEtMi42NC0uNzgsMTAuMywxMC4zLDAsMCwxLTIuNjMtMi4ydi0zLjE4bDEuODYuMjFhMi43NiwyLjc2LDAsMCwwLDIuNzktMS40MiwxMi40MSwxMi40MSwwLDAsMCwuNjktNC41MywxNi44LDE2LjgsMCwwLDAtMS44Ni02LjY1LDQ0LjUsNDQuNSwwLDAsMC00LjQxLTcuMjNsNi0xNi42NGgtNi41OFYxMTUuMmE0LjM5LDQuMzksMCwwLDEtMS4wOSwyLjkxLDQuNjUsNC42NSwwLDAsMS0zLjMzLDEuMzRoLTQuNDJabTI5LDYyLjE3LTQuNDItNi4xNmEzLjM4LDMuMzgsMCwwLDAsMi4zMi0zLjU0di01MmgzOC4xM1Y4NS4xMWE1LjMyLDUuMzIsMCwwLDEtMi4xNyw0LjM5LDguNzUsOC43NSwwLDAsMS0zLDEuMjcsMTguMTUsMTguMTUsMCwwLDEtNC40Mi40M2gtNy4zNmE0My45NCw0My45NCwwLDAsMCw0LDguNDIsOTkuNDYsOTkuNDYsMCwwLDAsOS45Mi03Ljg2bDUuODEsNC44MmE0MCw0MCwwLDAsMS0xMi42Myw3LjM2LDMyLjIsMzIuMiwwLDAsMCw3LjIxLDYuMjMsNDcuMjksNDcuMjksMCwwLDAsOC43Niw0LjI1bC0yLjMzLDRhNzMuMTksNzMuMTksMCwwLDEtOS42OS0zLjQ3LDM2LjI5LDM2LjI5LDAsMCwxLTkuNDUtNS44OCwzNCwzNCwwLDAsMS02LjQzLTcuODYsNDguNzMsNDguNzMsMCwwLDEtNC4yNy0xMEgxMTUxdjE5LjYxbDEwLjM5LTMuNjguOTMsNC41M3EtOS4zLDUtMTguODMsOS43TTExNTEsNzIuNDNoMTguOTFWNjUuNzFIMTE1MVptMTguOTEsNi4xNkgxMTUxdjYuNTJoMTguOTFaIi8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNMTIwMy43Myw3NS4zNGE3Myw3MywwLDAsMCwxMC42Mi0xNy40OWwxMC42MiwxLjJBMTA2LjcsMTA2LjcsMCwwLDEsMTIxOC44NSw3MGE3Ni40OCw3Ni40OCwwLDAsMS03LjY4LDkuNjMsNjAuNjQsNjAuNjQsMCwwLDEtMTksMTNsLTIuMzMtNC4xYTc2LDc2LDAsMCwwLDEzLjg3LTEzLjFtMzYuNDMsMTcuMDZxNS44LDcuNzIsMTEuMjQsMTUuNjUsMy40OCw1LjEsNy4yLDEwLjA2bC0zLjI1LDIuODNhNDAuNTgsNDAuNTgsMCwwLDEtOS44NC03LjI5cS0xMy42NSwxLjI2LTI3LjIxLDIuNzYtOC43Ni45MS0xNy41MSwyLjE5bC0zLjQxLTcuMjlhOS44OSw5Ljg5LDAsMCwwLDMuMzMtMSwxMy40OCwxMy40OCwwLDAsMCwyLjcxLTIuNjJBMTQxLjE5LDE0MS4xOSwwLDAsMCwxMjEyLjQ5LDk1cTQuNjUtNy4zNiw4LjYtMTUuMDhsMTAuNTQsMi44M2ExMDEuOCwxMDEuOCwwLDAsMS0xMC40NiwxNi41LDU4LjkzLDU4LjkzLDAsMCwxLTYuODIsNy4yMiw0NC4wOSw0NC4wOSwwLDAsMS01LjY2LDQuMzlsMzIuNTUtMS43N2ExNDUuODMsMTQ1LjgzLDAsMCwxLTkuNzYtMTIuNzRabS4wOC0zNS41NGE4OC44Myw4OC44MywwLDAsMCw0Ljg4LDEwLjQ4LDYwLjM3LDYwLjM3LDAsMCwwLDUuNzMsOC42M0E1Mi4zNyw1Mi4zNywwLDAsMCwxMjY1LDg4LjA4bC0yLjQ4LDQuMzJhNjQuOCw2NC44LDAsMCwxLTkuNDYtNC41Myw1MS43NSw1MS43NSwwLDAsMS05Ljc2LTcuNTEsNTUuNzcsNTUuNzcsMCwwLDEtNy4yOS05LjQ4LDc1LjQzLDc1LjQzLDAsMCwxLTUuNjYtMTEuNjlaIi8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNMTI3Mi45NCw3My4wN2g1MS45MlY3OS44aC01MS45MlptNDkuNDQsNDAuMzZhMTguNzIsMTguNzIsMCwwLDAsMi43OS0uMjEsMy44NiwzLjg2LDAsMCwwLDEuMzItLjcxLDMuODEsMy44MSwwLDAsMCwuODUtMS42MywxNC40NywxNC40NywwLDAsMCwuMjQtMi42OVY2Ni42M2gtNTAuODRWNTkuNjloNjEuNjlWMTExLjFhMTQuNjMsMTQuNjMsMCwwLDEtLjcsNC4zOSw2LjYzLDYuNjMsMCwwLDEtMi4zMywyLjc2LDEwLjEyLDEwLjEyLDAsMCwxLTIuOTQsMS4yLDI5LjMyLDI5LjMyLDAsMCwxLTUuNzQuNTcsMjcuMjQsMjcuMjQsMCwwLDEtMTMuMjUtMy40N3YtMy40N1ptLTIuOTQtMjcuNTR2MjAuMzlhNS44MSw1LjgxLDAsMCwxLTIuNDgsNC44OSw5LjksOS45LDAsMCwxLTMuNDksMS40OCwyMi4zLDIyLjMsMCwwLDEtNSwuNDNoLTMwLjkyVjg1Ljg5Wm0tMzAuOTIsMjAuMzloMTkuOTFWOTIuNjloLTE5LjkxWiIvPjxwYXRoIGNsYXNzPSJjbHMtMiIgZD0iTTQwNC4zOCwxNTguNzhhNDAuNCw0MC40LDAsMCwwLDkuMTQsMS40OGMzLDAsNS4yNC0uOTIsNS4yNC0zLjQ3LDAtNC44Mi0xNC45LTMuNTgtMTQuOS0xMy4xLDAtNi43Niw2LjY2LTguMDgsMTIuMjgtOC4wOGE0MS42MSw0MS42MSwwLDAsMSw5LjUxLDEuMTZsLTEuMjIsNC44OWEyOC42LDI4LjYsMCwwLDAtNy41NC0xLjIzYy0zLjc1LDAtNS43MiwxLTUuNzIsMywwLDQuODksMTQuODUsMy43LDE0Ljg1LDEzLjEzLDAsNi40MS01LjcxLDguNTItMTEuOCw4LjUyYTM3LjI5LDM3LjI5LDAsMCwxLTExLjE1LTEuNDdaIi8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNNDMwLjQ4LDE2NC42OFYxMzYuMDVINDQ0YzExLjY3LDAsMTMuMTIsMy41NCwxMy4xMiwxMC43MVYxNTRjMCw4LTIuMzQsMTAuNzEtMTMuMTIsMTAuNzFabTE5LjMtMTcuOTJjMC0zLjc4LS44NC01LjYxLTYuOTMtNS42MWgtNS4zdjE4LjQzaDUuM2M2LjA5LDAsNi45My0xLjgzLDYuOTMtNS42MVoiLz48cmVjdCBjbGFzcz0iY2xzLTIiIHg9IjQ2MS42OCIgeT0iMTM2LjA1IiB3aWR0aD0iNy4wOCIgaGVpZ2h0PSIyOC42MyIvPjxwYXRoIGNsYXNzPSJjbHMtMiIgZD0iTTQ5Ny4xMSwxNjMuNTZhMjYuNTUsMjYuNTUsMCwwLDEtOC43NiwxLjUxaC0uNzVjLTkuNjYsMC0xNC4zLTIuNy0xNC4zLTExVjE0Ni42YzAtOC4yOCw0LjY0LTExLDE0LjMtMTFoLjc1YTI3LjkxLDI3LjkxLDAsMCwxLDguNzYsMS41MWwtMS4zNiw0Ljc0YTMwLDMwLDAsMCwwLTcuNC0xLjExaC0uNzVjLTYsMC03LDEuNzUtNyw1Ljg1djcuNDljMCw0LjA5LDEsNS44NSw3LDUuODVoLjc1YTMxLjYsMzEuNiwwLDAsMCw3LjQtMS4wOFoiLz48cG9seWdvbiBjbGFzcz0iY2xzLTIiIHBvaW50cz0iNTMyLjIgMTY0LjY4IDUzMi4yIDE1Mi42NSA1MTkuMTMgMTUyLjY1IDUxOS4xMyAxNjQuNjggNTEyLjA2IDE2NC42OCA1MTIuMDYgMTM2LjA1IDUxOS4xMyAxMzYuMDUgNTE5LjEzIDE0Ny41MSA1MzIuMiAxNDcuNTEgNTMyLjIgMTM2LjA1IDUzOS4yOCAxMzYuMDUgNTM5LjI4IDE2NC42OCA1MzIuMiAxNjQuNjgiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik01NTcuMTMsMTY1LjExYy05LjA5LDAtMTMuMTYtMi43OC0xMy4xNi0xMS4xOFYxMzYuMDVINTUxVjE1NGMwLDQuMTguODksNiw2LjA5LDZoLjM4YzUuMjUsMCw2LjA5LTEuODMsNi4wOS02VjEzNi4wNWg3LjA3djE3Ljg4YzAsOC40LTQuMDcsMTEuMTgtMTMuMTYsMTEuMThaIi8+PHBvbHlnb24gY2xhc3M9ImNscy0yIiBwb2ludHM9IjYxMi4yNCAxNjQuNjggNjA3Ljg4IDE0Ni4zMiA1OTkuOTYgMTY1LjA3IDU5My4yMSAxNjUuMDcgNTg1LjE1IDE0Ni4zMiA1ODAuOTQgMTY0LjY4IDU3My42NyAxNjQuNjggNTgxLjY0IDEzNS45NyA1ODcuNTQgMTM1Ljk3IDU5Ni41OSAxNTcuNTEgNjA1LjYzIDEzNS45NyA2MTEuNTMgMTM1Ljk3IDYxOS41IDE2NC42OCA2MTIuMjQgMTY0LjY4Ii8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNNjQzLDE2NC42OGwtMS43NC01LjM4SDYzMC40N2wtMS43NCw1LjM4aC03LjU5bDExLjY3LTI4LjYzaDZsMTEuNzIsMjguNjNaTTYzMi4xLDE1NC4xN2g3LjQ2bC0zLjcxLTExLjQ3WiIvPjxwb2x5Z29uIGNsYXNzPSJjbHMtMiIgcG9pbnRzPSI2NjAuODggMTM2LjA1IDY3My42NyAxNTQuNjQgNjczLjY3IDEzNi4wNSA2ODAuNjUgMTM2LjA1IDY4MC42NSAxNjQuNjggNjczLjY3IDE2NC42OCA2NjAuODggMTQ2LjQgNjYwLjg4IDE2NC42OCA2NTMuODkgMTY0LjY4IDY1My44OSAxMzYuMDUgNjYwLjg4IDEzNi4wNSIvPjxwYXRoIGNsYXNzPSJjbHMtMiIgZD0iTTY5Ny4wNSwxNjQuNjhWMTM2LjA1aDEyLjUxYzguNTMsMCwxMi43LDEuNjMsMTIuNyw5LjI0LDAsNS4yNS0yLDcuNjQtNiw4LjY0bDYuMTgsMTAuNzVINzE0LjlsLTUuNTMtMTAuMTZoLTUuMjR2MTAuMTZabTEyLjUxLTE1LjI1YzQuNDEsMCw1LjM0LS43Niw1LjM0LTQuMTRzLS45My00LjE1LTUuMzQtNC4xNWgtNS40M3Y4LjI5WiIvPjxwb2x5Z29uIGNsYXNzPSJjbHMtMiIgcG9pbnRzPSI3MjYuNjYgMTY0LjY4IDcyNi42NiAxMzYuMDUgNzQ5LjIgMTM2LjA1IDc0OS4yIDE0MS4xNCA3MzMuNzQgMTQxLjE0IDczMy43NCAxNDcuNCA3NDYuODEgMTQ3LjQgNzQ2LjgxIDE1Mi40OSA3MzMuNzQgMTUyLjQ5IDczMy43NCAxNTkuNTggNzQ5LjIgMTU5LjU4IDc0OS4yIDE2NC42OCA3MjYuNjYgMTY0LjY4Ii8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNNzU0LjUsMTU4Ljc4YTQwLjQsNDAuNCwwLDAsMCw5LjEzLDEuNDhjMywwLDUuMjUtLjkyLDUuMjUtMy40NywwLTQuODItMTQuOS0zLjU4LTE0LjktMTMuMSwwLTYuNzYsNi42Ni04LjA4LDEyLjI4LTguMDhhNDEuNjEsNDEuNjEsMCwwLDEsOS41MSwxLjE2bC0xLjIyLDQuODlhMjguNiwyOC42LDAsMCwwLTcuNTQtMS4yM2MtMy43NSwwLTUuNzIsMS01LjcyLDMsMCw0Ljg5LDE0Ljg2LDMuNywxNC44NiwxMy4xMywwLDYuNDEtNS43Miw4LjUyLTExLjgxLDguNTJhMzcuMjksMzcuMjksMCwwLDEtMTEuMTUtMS40N1oiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik03OTQuMTQsMTY1LjA4Yy05LjM3LDAtMTMuOTItMi43MS0xMy45Mi0xMXYtNy40NWMwLTguMzYsNC40Ni0xMSwxMy45Mi0xMWguNTZjOS4zNywwLDEzLjkyLDIuNzEsMTMuOTIsMTF2Ny40NWMwLDguMjgtNC41NSwxMS0xMy45MiwxMVptNy4xNy0xOC40NGMwLTQuMTQtMS01Ljg5LTYuNjEtNS44OWgtLjU2Yy01LjYyLDAtNi42MSwxLjc1LTYuNjEsNS44OXY3LjQ1YzAsNC4wOSwxLDUuODUsNi42MSw1Ljg1aC41NmM1LjYzLDAsNi42MS0xLjc2LDYuNjEtNS44NVoiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik04MjYuMSwxNjUuMTFjLTkuMDksMC0xMy4xNy0yLjc4LTEzLjE3LTExLjE4VjEzNi4wNUg4MjBWMTU0YzAsNC4xOC44OSw2LDYuMDksNmguMzdjNS4yNSwwLDYuMDktMS44Myw2LjA5LTZWMTM2LjA1aDcuMDh2MTcuODhjMCw4LjQtNC4wOCwxMS4xOC0xMy4xNywxMS4xOFoiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik04NDQuMzIsMTY0LjY4VjEzNi4wNWgxMi41MmM4LjUyLDAsMTIuNjksMS42MywxMi42OSw5LjI0LDAsNS4yNS0yLDcuNjQtNS45NSw4LjY0bDYuMTksMTAuNzVoLTcuNTlsLTUuNTMtMTAuMTZIODUxLjR2MTAuMTZabTEyLjUyLTE1LjI1YzQuNCwwLDUuMzQtLjc2LDUuMzQtNC4xNHMtLjk0LTQuMTUtNS4zNC00LjE1SDg1MS40djguMjlaIi8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNODk3LjM3LDE2My41NmEyNi41NiwyNi41NiwwLDAsMS04Ljc3LDEuNTFoLS43NWMtOS42NSwwLTE0LjI5LTIuNy0xNC4yOS0xMVYxNDYuNmMwLTguMjgsNC42NC0xMSwxNC4yOS0xMWguNzVhMjcuOTIsMjcuOTIsMCwwLDEsOC43NywxLjUxTDg5NiwxNDEuODZhMzAsMzAsMCwwLDAtNy40MS0xLjExaC0uNzVjLTYsMC03LDEuNzUtNyw1Ljg1djcuNDljMCw0LjA5LDEsNS44NSw3LDUuODVoLjc1YTMxLjYxLDMxLjYxLDAsMCwwLDcuNDEtMS4wOFoiLz48cG9seWdvbiBjbGFzcz0iY2xzLTIiIHBvaW50cz0iOTAwLjg0IDE2NC42OCA5MDAuODQgMTM2LjA1IDkyMy4zNyAxMzYuMDUgOTIzLjM3IDE0MS4xNCA5MDcuOTEgMTQxLjE0IDkwNy45MSAxNDcuNCA5MjAuOTggMTQ3LjQgOTIwLjk4IDE1Mi40OSA5MDcuOTEgMTUyLjQ5IDkwNy45MSAxNTkuNTggOTIzLjM3IDE1OS41OCA5MjMuMzcgMTY0LjY4IDkwMC44NCAxNjQuNjgiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik05MjguNjcsMTU4Ljc4YTQwLjQsNDAuNCwwLDAsMCw5LjE0LDEuNDhjMywwLDUuMjQtLjkyLDUuMjQtMy40NywwLTQuODItMTQuOS0zLjU4LTE0LjktMTMuMSwwLTYuNzYsNi42Ni04LjA4LDEyLjI4LTguMDhhNDEuNjEsNDEuNjEsMCwwLDEsOS41MSwxLjE2bC0xLjIyLDQuODlhMjguNiwyOC42LDAsMCwwLTcuNTQtMS4yM2MtMy43NSwwLTUuNzIsMS01LjcyLDMsMCw0Ljg5LDE0Ljg2LDMuNywxNC44NiwxMy4xMywwLDYuNDEtNS43Miw4LjUyLTExLjgxLDguNTJhMzcuMjksMzcuMjksMCwwLDEtMTEuMTUtMS40N1oiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik05NjcuMjgsMTU4Ljc4YTQwLjQsNDAuNCwwLDAsMCw5LjEzLDEuNDhjMywwLDUuMjUtLjkyLDUuMjUtMy40NywwLTQuODItMTQuOS0zLjU4LTE0LjktMTMuMSwwLTYuNzYsNi42Ni04LjA4LDEyLjI4LTguMDhhNDEuNjEsNDEuNjEsMCwwLDEsOS41MSwxLjE2bC0xLjIyLDQuODlhMjguNiwyOC42LDAsMCwwLTcuNTQtMS4yM2MtMy43NSwwLTUuNzIsMS01LjcyLDMsMCw0Ljg5LDE0Ljg2LDMuNywxNC44NiwxMy4xMywwLDYuNDEtNS43Miw4LjUyLTExLjgxLDguNTJBMzcuMjksMzcuMjksMCwwLDEsOTY2LDE2My42WiIvPjxwb2x5Z29uIGNsYXNzPSJjbHMtMiIgcG9pbnRzPSI5OTMuMzggMTY0LjY4IDk5My4zOCAxMzYuMDUgMTAxNS45MiAxMzYuMDUgMTAxNS45MiAxNDEuMTQgMTAwMC40NiAxNDEuMTQgMTAwMC40NiAxNDcuNCAxMDEzLjUzIDE0Ny40IDEwMTMuNTMgMTUyLjQ5IDEwMDAuNDYgMTUyLjQ5IDEwMDAuNDYgMTU5LjU4IDEwMTUuOTIgMTU5LjU4IDEwMTUuOTIgMTY0LjY4IDk5My4zOCAxNjQuNjgiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik0xMDIwLjE4LDE2NC42OFYxMzYuMDVoMTIuNTFjOC41MywwLDEyLjcsMS42MywxMi43LDkuMjQsMCw1LjI1LTIsNy42NC02LDguNjRsNi4xOCwxMC43NUgxMDM4bC01LjUzLTEwLjE2aC01LjI0djEwLjE2Wm0xMi41MS0xNS4yNWM0LjQsMCw1LjM0LS43Niw1LjM0LTQuMTRzLS45NC00LjE1LTUuMzQtNC4xNWgtNS40M3Y4LjI5WiIvPjxwb2x5Z29uIGNsYXNzPSJjbHMtMiIgcG9pbnRzPSIxMDU5LjczIDE2NS4wNyAxMDQ4LjA2IDEzNi4wNSAxMDU1LjY1IDEzNi4wNSAxMDYyLjc4IDE1Ny40MyAxMDY5Ljg5IDEzNi4wNSAxMDc3LjQ5IDEzNi4wNSAxMDY1Ljc3IDE2NS4wNyAxMDU5LjczIDE2NS4wNyIvPjxyZWN0IGNsYXNzPSJjbHMtMiIgeD0iMTA4MC42NyIgeT0iMTM2LjA1IiB3aWR0aD0iNy4wOCIgaGVpZ2h0PSIyOC42MyIvPjxwYXRoIGNsYXNzPSJjbHMtMiIgZD0iTTExMTYuMSwxNjMuNTZhMjYuNTYsMjYuNTYsMCwwLDEtOC43NywxLjUxaC0uNzRjLTkuNjYsMC0xNC4yOS0yLjctMTQuMjktMTFWMTQ2LjZjMC04LjI4LDQuNjMtMTEsMTQuMjktMTFoLjc0YTI3LjkyLDI3LjkyLDAsMCwxLDguNzcsMS41MWwtMS4zNiw0Ljc0YTMwLDMwLDAsMCwwLTcuNDEtMS4xMWgtLjc0Yy02LDAtNywxLjc1LTcsNS44NXY3LjQ5YzAsNC4wOSwxLDUuODUsNyw1Ljg1aC43NGEzMS42MSwzMS42MSwwLDAsMCw3LjQxLTEuMDhaIi8+PHBvbHlnb24gY2xhc3M9ImNscy0yIiBwb2ludHM9IjExMTkuNTcgMTY0LjY4IDExMTkuNTcgMTM2LjA1IDExNDIuMSAxMzYuMDUgMTE0Mi4xIDE0MS4xNCAxMTI2LjY0IDE0MS4xNCAxMTI2LjY0IDE0Ny40IDExMzkuNzEgMTQ3LjQgMTEzOS43MSAxNTIuNDkgMTEyNi42NCAxNTIuNDkgMTEyNi42NCAxNTkuNTggMTE0Mi4xIDE1OS41OCAxMTQyLjEgMTY0LjY4IDExMTkuNTcgMTY0LjY4Ii8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNMTE4MS4yOCwxNjMuNTZhMjYuNTYsMjYuNTYsMCwwLDEtOC43NywxLjUxaC0uNzVjLTkuNjUsMC0xNC4yOS0yLjctMTQuMjktMTFWMTQ2LjZjMC04LjI4LDQuNjQtMTEsMTQuMjktMTFoLjc1YTI3LjkyLDI3LjkyLDAsMCwxLDguNzcsMS41MWwtMS4zNiw0Ljc0YTMwLDMwLDAsMCwwLTcuNDEtMS4xMWgtLjc1Yy02LDAtNywxLjc1LTcsNS44NXY3LjQ5YzAsNC4wOSwxLDUuODUsNyw1Ljg1aC43NWEzMS42MSwzMS42MSwwLDAsMCw3LjQxLTEuMDhaIi8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNMTE5Ny4xNiwxNjUuMDhjLTkuMzcsMC0xMy45Mi0yLjcxLTEzLjkyLTExdi03LjQ1YzAtOC4zNiw0LjQ2LTExLDEzLjkyLTExaC41NmM5LjM3LDAsMTMuOTIsMi43MSwxMy45MiwxMXY3LjQ1YzAsOC4yOC00LjU1LDExLTEzLjkyLDExWm03LjE3LTE4LjQ0YzAtNC4xNC0xLTUuODktNi42MS01Ljg5aC0uNTZjLTUuNjIsMC02LjYxLDEuNzUtNi42MSw1Ljg5djcuNDVjMCw0LjA5LDEsNS44NSw2LjYxLDUuODVoLjU2YzUuNjMsMCw2LjYxLTEuNzYsNi42MS01Ljg1WiIvPjxyZWN0IGNsYXNzPSJjbHMtMiIgeD0iMTIxNS44NiIgeT0iMTU4LjYyIiB3aWR0aD0iNi43IiBoZWlnaHQ9IjYuMDUiLz48cmVjdCBjbGFzcz0iY2xzLTIiIHg9IjEzMzEuNzMiIHk9IjE1OC42MiIgd2lkdGg9IjYuNyIgaGVpZ2h0PSI2LjA1Ii8+PHBvbHlnb24gY2xhc3M9ImNscy0yIiBwb2ludHM9IjEyMjYuMTIgMTY5LjIyIDEyMjguOTggMTU4LjQzIDEyMzYuODUgMTU4LjQzIDEyMzEuNyAxNjkuMjIgMTIyNi4xMiAxNjkuMjIiLz48cG9seWdvbiBjbGFzcz0iY2xzLTIiIHBvaW50cz0iMTI1MS43IDE2NC42OCAxMjUxLjcgMTM2LjA1IDEyNTguNzggMTM2LjA1IDEyNTguNzggMTU5LjU4IDEyNzMuNCAxNTkuNTggMTI3My40IDE2NC42OCAxMjUxLjcgMTY0LjY4Ii8+PHBvbHlnb24gY2xhc3M9ImNscy0yIiBwb2ludHM9IjEyNzkuOTYgMTY0LjY4IDEyNzkuOTYgMTQxLjE0IDEyNzAuNDkgMTQxLjE0IDEyNzAuNDkgMTM2LjA1IDEyOTYuNSAxMzYuMDUgMTI5Ni41IDE0MS4xNCAxMjg3LjAzIDE0MS4xNCAxMjg3LjAzIDE2NC42OCAxMjc5Ljk2IDE2NC42OCIvPjxwYXRoIGNsYXNzPSJjbHMtMiIgZD0iTTEyOTkuODcsMTY0LjY4VjEzNi4wNWgxMy41YzExLjY2LDAsMTMuMTIsMy41NCwxMy4xMiwxMC43MVYxNTRjMCw4LTIuMzUsMTAuNzEtMTMuMTIsMTAuNzFabTE5LjMxLTE3LjkyYzAtMy43OC0uODUtNS42MS02Ljk0LTUuNjFIMTMwN3YxOC40M2g1LjI5YzYuMDksMCw2Ljk0LTEuODMsNi45NC01LjYxWiIvPjwvc3ZnPg=='/>
</div>
<div style="display: flex; justify-content: center; align-items: center; height: 28px">
  <div
    style="
      background-color: #cd5d58;
      -webkit-print-color-adjust: exact;
      border-radius: 15px;
      padding: 5px 10px;
      color: #fff;
    "
  >
    职业心理风险测验报告
  </div>
  <i
    style="
      margin-left: 10px;
      width: 3px;
      height: 20px;
      border-radius: 5px;
      background-color: #cd5d58;
      -webkit-print-color-adjust: exact;
    "
  ></i>
</div>
</div><div style="height: 40px;"></div>`;

// puppeteer
// (async () => {
//   try {
//     let browser = await puppeteer.launch({
//       args: [
//         // Required for Docker version of Puppeteer
//         "--no-sandbox",
//         "--disable-setuid-sandbox",
//         // This will write shared memory files into /tmp instead of /dev/shm,
//         // because Docker’s default for /dev/shm is 64MB
//         "--disable-dev-shm-usage"
//       ]
//     });

//     const browserVersion = await browser.version();
//     console.log(`Started ${browserVersion}`);
//     const page = await browser.newPage();
//     await page.goto("http://localhost:8080/", {
//       waitUntil: "networkidle0",
//       timeout: 600000
//     });
//     await waitTillHTMLRendered(page);
//     const cover_buffer = await exportBuffer(page, false);
//     await page.addStyleTag({
//       content: "#cover {display:none}"
//     })
//     const content_buffer = await exportBuffer(page);
//     await mergeBuffer(cover_buffer, content_buffer);
//     await browser.close();
//   } catch (e) {
//     console.log(e);
//   }
// })();

// playwright
(async () => {
  const browser = await chromium.launch();  // Or 'firefox' or 'webkit'.
  const url = "https://conch-admin.stac.fun/#/offline/admission/ticket/767c34e3a99a4597abca967584cde678"
  const page = await browser.newPage();
  await page.goto(url, {
      waitUntil: "networkidle",
      timeout: 600000
    });
    await waitTillHTMLRendered(page);
    // await page.waitForSelector("#cover")
    // const cover_buffer = await exportBuffer(page, false);
    // await page.addStyleTag({
    //   content: "#cover {display:none}"
    // })
    // const content_buffer = await exportBuffer(page);
    // await mergeBuffer(cover_buffer, content_buffer);
    // await browser.close();
    await exportPDF(page)
})();
// 导出pdf
async function exportPDF(page) {
  await page.pdf({ 
    path: `h1.pdf`, format: "a4" , 
    printBackground: true,
    '-webkit-print-color-adjust': 'exact',
    displayHeaderFooter: false,
    headerTemplate,
    footerTemplate,
    margin: {
      top: 80,
      bottom: 80
    },
  });
}

// 导出buffer
async function exportBuffer(page, hasHeaderFooter = true) {
  const options = {
    format: "a4",
    printBackground: true,
    '-webkit-print-color-adjust': 'exact'
  }
  return hasHeaderFooter ? await page.pdf({
    ...options,
    displayHeaderFooter: true,
    headerTemplate,
    footerTemplate,
    margin: {
      top: 120,
      bottom: 100
    },
  }):await page.pdf(options)
}


// 合并 buffer
async function mergeBuffer(cover_buffer, content_buffer) {
  const pdfDoc = await PDFDocument.create()
  const coverDoc = await PDFDocument.load(cover_buffer)
  const [coverPage] = await pdfDoc.copyPages(coverDoc, [0])
  pdfDoc.addPage(coverPage)
  const mainDoc = await PDFDocument.load(content_buffer)
  for (let i = 0; i < mainDoc.getPageCount(); i++) {
      const [aMainPage] = await pdfDoc.copyPages(mainDoc, [i])
      pdfDoc.addPage(aMainPage)
  }
  const pdfBytes = await pdfDoc.save()
  const pdf_path = 'a4.pdf'
  await writeFile(pdf_path, pdfBytes);
}

// writeFile
async function writeFile(path, data) {
  return new Promise((resolve, reject) => {
    fs.writeFile(path, data, err => {
      if (err) reject(err)
      resolve()
    })
  })
}